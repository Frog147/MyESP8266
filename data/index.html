<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<title>MyESP</title>
		<style>
			body {
				background: #212121;
			}
			.brick {
				width: 300px;
				margin: 4px;
				padding: 6px;
				float: left;
				border-radius: 12px;
				background: #50505077;
			}
			.text {
				color: rgba(150, 255, 200, 0.8);
				font-family: Arial;
				padding: 2px;
			}
			.switchStateOff {
				background: #4e070740
			}
			.switchStateOff:active {
				background: #50505077
			}
			.switchStateOn {
				background: #09490a3b
			}
			.switchStateOn:active {
				background: #50505077
			}
		</style>
	</head>
	
	<body>
		<header>
			<div>
				<h1 class="text" id="header">Date</h1>
			</div>
		</header>

		<div class="brick" id="btnOneExtendedJsonDoc">
			<div class="text">btnOneExtendedJsonDoc</div>
			<div class="text">...</div>
			<div class="text">...</div>
		</div>

		<script>
			"use strict";

			let JsonDoc;
			/*
			JsonDoc = {
				"000":{"info":"T", "value":15, "time":"12:56"}, 
				"001":{"info":"H", "value":60, "time":"08:23"},
				"002":{"info":"V", "value":34, "time":"12:56"}, 
				"003":{"info":"B", "value":true, "time":"08:23"},
			};
			let oneExtendedJsonDoc = {
				"000":{"info":"T", 
						"value":[10, 11, 12, 13, 14, 15], 
						"time":["07:56", "08:56", "09:56", "10:56", "11:56", "12:56"]}, 
			};
			*/
			let header = document.getElementById('header');
			let date = new Date();	/* перенести в отдельную функцию и добавить к нему обневение ежесекундно */
			header.textContent = date.getDate() + '.' + (+date.getMonth()+1) + '.' + date.getFullYear();
			
			window.addEventListener('load', function() {
				let xhr = new XMLHttpRequest();
				xhr.open('GET', '/get_json', true);
				xhr.onload = () => {
					JsonDoc = JSON.parse(xhr.response);
					for (let id in JsonDoc) { // добавление элементов на экран
						addNewBrick(id, JsonDoc[id].info, JsonDoc[id].value, JsonDoc[id].time);
					}

					// выставим функцию для обработки нажатия
					let btnSwicthLed = document.getElementById("000");
					btnSwicthLed.addEventListener('click', function() {
						let xhr = new XMLHttpRequest();
						xhr.open('GET', '/led_switch', false);
						xhr.onload = () => {
						if(+xhr.response) {
							btnSwicthLed.classList.remove('switchStateOn');
							btnSwicthLed.classList.add('switchStateOff');
						}
						else {
							btnSwicthLed.classList.remove('switchStateOff');
							btnSwicthLed.classList.add('switchStateOn');
						}
						}
						xhr.send();
					});
				}
				xhr.send();
			});

			let btnOneExtendedJson = document.getElementById("btnOneExtendedJsonDoc");
			btnOneExtendedJson.addEventListener('click', function() {
				for (let id in oneExtendedJsonDoc) {
					addNewBrick(oneExtendedJsonDoc[id].info, oneExtendedJsonDoc[id].value, oneExtendedJsonDoc[id].time);
				}
			});

			function addNewBrick(id, info, value, time) {
				let divBrick = document.createElement('div');
				divBrick.classList.add('brick');
				divBrick.id = id;

				let divInfo = document.createElement('div');
				divInfo.classList.add('text');
				divInfo.textContent = info;

				let divValue = document.createElement('div');
				divValue.classList.add('text');
				divValue.textContent = value;

				let divTime = document.createElement('div');
				divTime.classList.add('text');
				divTime.textContent = time;

				document.body.appendChild(divBrick);
				divBrick.appendChild(divInfo);
				divBrick.appendChild(divValue);
				divBrick.appendChild(divTime);
			}

		</script>
	</body>
	
</html>